!function(t){"use strict";window.rhye.components.GoogleMap=class extends window.rhye.components.Base{constructor({scope:t,target:e}){super({scope:t,target:e})}set(){this.prevInfoWindow=!1,this.$container=this.$target.find(".gmap__container"),this.$markers=this.$target.find(".gmap__marker"),this.zoom=parseInt(this.$target.data("gmap-zoom")),this.styles=this._parseStyles(this.$target.attr("data-gmap-snazzy-styles"))}run(){this.$container.length&&this._createMap()}_parseStyles(t){if(!t)return!1;try{return JSON.parse(t)}catch(t){return console.error("Google Map: Invalid Snazzy Styles Array!"),!1}}_createMap(){const e=this,a={center:new google.maps.LatLng(0,0),zoom:this.zoom,scrollwheel:!1};this.styles&&t.extend(a,{styles:this.styles}),this.map=new google.maps.Map(this.$container[0],a),this.map.markers=[],this.$markers.each((function(){e._createMarker(t(this))})),this._centerMap(this.zoom)}_createMarker(e){if(!e.length)return;const a=parseFloat(e.attr("data-marker-lat")),s=parseFloat(e.attr("data-marker-lon")),n=e.attr("data-marker-img"),o=e.attr("data-marker-width"),r=e.attr("data-marker-height"),i=e.attr("data-marker-content");let p;const h={position:new google.maps.LatLng(a,s),map:this.map};n&&t.extend(h,{icon:{url:n}}),n&&o&&r&&t.extend(h.icon,{scaledSize:new google.maps.Size(o,r),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,0)}),p=new google.maps.Marker(h),this.map.markers.push(p),this._createInfoWindow({marker:p,content:i})}_createInfoWindow({marker:t,content:e=""}){if(e){const a=new google.maps.InfoWindow({content:e});t.addListener("click",(()=>{this.prevInfoWindow&&this.prevInfoWindow.close(),this.prevInfoWindow=a,a.open(this.map,t)}))}}_centerMap(e){const a=new google.maps.LatLngBounds;t.each(this.map.markers,(function(){const t=this;if(void 0!==t.position){const e=t.position.lat(),s=t.position.lng(),n=new google.maps.LatLng(e,s);a.extend(n)}})),1==this.map.markers.length?(this.map.setCenter(a.getCenter()),this.map.setZoom(e)):this.map.fitBounds(a)}}}(jQuery);