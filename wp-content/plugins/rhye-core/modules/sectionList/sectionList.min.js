!function(e){"use strict";window.rhye.components.SectionList=class extends window.rhye.components.ScrollAnimation{constructor({target:e,scope:t}){super({target:e,scope:t})}set(){this.$listHoverContainer=this.$el.find(".js-list-hover"),this.$listHoverLinks=this.$el.find(".js-list-hover__link"),this.$listHoverThumbs=this.$el.find(".js-list-thumbs"),this.$listHoverThumbsLinks=this.$el.find(".js-list-thumbs__link"),this.$listItems=this.$el.find(".list-projects__item"),this.$listImages=this.$el.find(".list-projects__cover img, .list-projects__thumbnail"),this.$wrapperLinks=this.$el.find(".list-projects__wrapper-link"),this.$wrapperButtons=this.$el.find(".list-projects__wrapper-button"),this.listHoverClass="list-projects_hover",this.$canvas=this.$scope.find(".js-list-hover__canvas"),this.retinaEnabled=this.$listHoverContainer.data("arts-hover-retina-enabled")||!1,this.enabledAtResolution=this.$listHoverContainer.data("arts-hover-enabled-at")||768,this.isOffscreenRunning=!1,this.listHoverOptions={strength:this.$listHoverContainer.data("arts-hover-strength")||0,scaleTexture:this.$listHoverContainer.data("arts-hover-scale-texture")||1.8,scalePlane:this.$listHoverContainer.data("arts-hover-scale-plane")||1},this.$listHoverContainer.length&&(this.$listImages,this._bindEventsHover(),this._isThreeSceneEnabled()?this.isOffscreenCanvasSupported()&&!this.isOffscreenRunning?this._loadThreeOffscreen():this._loadThree():(this.lazyImages=new window.rhye.components.LazyLoad({images:this.$listImages}),window.$window.on("resize",window.rhye.functions.debounce((()=>{this._isThreeSceneEnabled()&&(this.isOffscreenCanvasSupported()&&!this.isOffscreenRunning?this._loadThreeOffscreen():"undefined"!=typeof THREE&&void 0!==window.rhye.components.EffectStretch||this._loadThree())}),300))),window.$barbaWrapper.length&&this._bindEventsClick()),this.$listHoverThumbs.length&&(this._bindEventsHover(),this._bindEventsHoverCovers()),this._hasAnimationScene(this.$el)?(this._setAnimation(),this._animate()):gsap.effects.hideLines(this.$el.find(".js-change-text-hover__hover"),{ease:"power3.out",duration:0,stagger:0})}_isThreeSceneEnabled(){return window.Modernizr.mq(`(min-width: ${this.enabledAtResolution}px)`)}_loadThree(){return window.rhye.components.AssetsManager.loadThree().then((()=>this._getHoverImagesEffect()))}_loadThreeOffscreen(){return this.isOffscreenRunning=!0,new window.rhye.components.ListStretchEffectWorker({target:this.$listHoverContainer,items:this.$listHoverLinks,canvas:this.$canvas.get(0),options:this.listHoverOptions,retinaEnabled:this.retinaEnabled})}isOffscreenCanvasSupported(){return window.theme.offscreenCanvas&&!window.theme.elementor.isEditor&&HTMLCanvasElement.prototype.transferControlToOffscreen}_getHoverImagesEffect(){return new window.rhye.components.EffectStretch({target:this.$listHoverContainer,items:this.$listHoverLinks,canvas:this.$canvas.get(0),options:this.listHoverOptions,retinaEnabled:this.retinaEnabled})}_bindEventsHover(){this.$listHoverLinks.on("mouseenter touchstart",(()=>{this.$listHoverContainer.addClass(this.listHoverClass)})).on("mouseleave touchend",(()=>{this.$listHoverContainer.removeClass(this.listHoverClass)})),this.$listHoverThumbsLinks.on("mouseenter touchstart",(()=>{this.$listHoverThumbs.addClass(this.listHoverClass)})).on("mouseleave touchend",(()=>{this.$listHoverThumbs.removeClass(this.listHoverClass)}))}_getTextureRatio(e){return e?"IMG"===e.tagName?e.naturalWidth/e.naturalHeight:"VIDEO"===e.tagName?e.videoWidth/e.videoHeight:void 0:0}_bindEventsClick(){const t=this,s=window.$body.offset().top;gsap.set(this.$listHoverLinks.find(".js-transition-img__transformed-el"),{scale:Math.abs(t.listHoverOptions.scaleTexture),transformOrigin:"center center"}),this.$listHoverLinks.on("click",(function(i){const n=e(this),o=n.find("img, video"),r=t._getTextureRatio(o[0]);let a,h;h=r>1?window.innerHeight/2/r:window.innerHeight/2/(r+1),a=h*r,n.data("coordinates",{top:i.clientY+s-h/2,left:i.clientX-a/2,width:a,height:h})}))}_bindEventsHoverCovers(){const t=this;this.$listHoverThumbsLinks.each((function(){const s=e(this),i=e(`.js-list-thumbs__cover[data-background-for="${s.data("post-id")}"]`);s.on("mouseenter touchstart",(function(){i.each((function(s){let i=e(this).find(".list-projects__cover-wrapper"),n=t._getRandomPosition(s,20);gsap.to(i,{x:`${n.x}%`,y:`${n.y}%`,ease:"power4.out",duration:1.2,height:"auto",stagger:.05})}))})).on("mouseleave touchend",(()=>{gsap.to(t.$listHoverThumbs.find(".list-projects__cover-wrapper"),{ease:"power4.out",duration:1.2,height:0,x:"0%",y:"0%"})}))}))}_getRandomPosition(e=0,t=20){const s=[];switch(e){case 0:s.x=gsap.utils.random(-t,0),s.y=gsap.utils.random(-t,-t);break;case 1:s.x=gsap.utils.random(0,t),s.y=gsap.utils.random(-t,t);break;case 2:s.x=gsap.utils.random(-t,t),s.y=gsap.utils.random(-t,0);break;default:s.x=gsap.utils.random(-t,t),s.y=gsap.utils.random(-t,t)}return s}_setAnimation(){gsap.set(this.$listImages,{opacity:0,transformOrigin:"center center"}),gsap.set(this.$wrapperButtons,{y:30,autoAlpha:0})}_animate(){const t=this;t._createScene({element:this.$el}),this.$listItems.each((function(){const s=e(this),i=new gsap.timeline,n=s.find(".list-projects__cover img, .list-projects__cover video, .list-projects__thumbnail"),o=s.find(".list-projects__header"),r=s.find(".list-projects__wrapper-button");i.add([gsap.to(n,{opacity:1,duration:1.2}),gsap.effects.animateWords(o,{duration:.9}),gsap.to(r,{autoAlpha:1,y:0,duration:.9}),gsap.effects.animateLines(s,{excludeEl:".js-change-text-hover__hover .split-text__line"})]),t._createScene({element:s,timeline:i,reveal:!1})}))}},window.rhye.components.ListStretchEffectWorker=class{constructor({target:e,items:t,canvas:s,options:i,retinaEnabled:n=!1}){this.target=e,this.canvas=s,this.items=t,this.options=i,this.viewport=this._getViewPort(),this.plane={offset:{x:0,y:0},position:{x:0,y:0}},this.canvas&&(this.offscreenCanvas=this.canvas.transferControlToOffscreen(),this.uniforms={uTexture:{value:null},uOffset:{value:0},uAlpha:{value:0},uScale:{value:0}},this.worker=this._getWorker(),this.timeline=new gsap.timeline,this.worker.postMessage({type:"init",canvas:this.offscreenCanvas,options:i,viewport:this.viewport,pixelsRatio:this._getPixelRatio(n)},[this.offscreenCanvas]),this._loadTextures(this.items),this.target.removeClass("pointer-events-none"),this.worker.postMessage({type:"run"}),this._bindMouseEvents(),this._bindEvents(),this._bindOffsetUpdate())}_bindOffsetUpdate(){this.worker.onmessage=e=>{"planeOffset"===e.data.type&&(this.plane.offset.x=e.data.offset.x,this.plane.offset.y=e.data.offset.y)}}_getPixelRatio(e=!1){return!0===e?window.devicePixelRatio:1}_getWorker(){return new Worker(window.plugin.assets["effect-stretch-offscreen-js"].src,{type:"module"})}_getViewPort(){return{width:window.innerWidth,height:window.innerHeight,aspectRatio:window.innerWidth/window.innerHeight}}_getCanvasView(){const e=this.canvas.getBoundingClientRect(),t={width:0,height:0,aspectRatio:0};return t.width=e.width,t.height=e.height,t.aspectRatio=this.aspectRatio,t}_loadTextures(e){const t=e.find("img, video").removeAttr("loading"),s=t.Lazy({chainable:!1,afterLoad:e=>{const s=t.index(e);e.one("load",(()=>{this.worker.postMessage({type:"loadTexture",index:s,url:e.get(0).currentSrc})}))}});s.update(),s.force(s.getItems())}_bindMouseEvents(){const t=this;this.items.each((function(s){e(this).on("mouseenter",(e=>{t._onMouseEnter(),t._onTargetChange(s)})).on("mouseleave",(e=>{t.isMouseOver=!1,t._onMouseLeave(e)}))})),window.$window.on("mousemove touchmove",(e=>{"touchmove"!==e.type&&(this.worker.postMessage({type:"updateMousePosition",mouse:{x:e.clientX/this.viewport.width*2-1,y:-e.clientY/this.viewport.height*2+1}}),this.worker.postMessage({type:"getOffset"}),this._onMouseMove(e))}))}_bindEvents(){window.$window.on("resize",window.rhye.functions.debounce((()=>{this.viewport=this._getViewPort(),this.worker.postMessage({type:"updateViewport",viewport:this.viewport,rect:this._getCanvasView()})}),250)),window.$window.one("arts/barba/transition/start",(()=>{this.worker.postMessage({type:"kill"}),this.worker.terminate()})).one("arts/barba/transition/init/before",(()=>{e(this.canvas).remove()}))}_onMouseEnter(){this.isMouseOver||(this.isMouseOver=!0,gsap.to(this.uniforms.uAlpha,{duration:.3,value:1,ease:"power4.out",onUpdate:()=>{this.worker.postMessage({type:"setAlpha",value:this.uniforms.uAlpha.value})}}))}_onMouseLeave(){gsap.to(this.uniforms.uAlpha,{duration:.3,value:0,ease:"power4.out",onUpdate:()=>{this.worker.postMessage({type:"setAlpha",value:this.uniforms.uAlpha.value})}})}_onMouseMove(e){gsap.to(this.plane.position,{duration:1,x:this.plane.offset.x,y:this.plane.offset.y,ease:"power4.out",onUpdate:()=>{this.worker.postMessage({type:"setPosition",position:{x:this.plane.position.x,y:this.plane.position.y}})}})}_onTargetChange(e){this.worker.postMessage({type:"setTarget",index:e})}}}(jQuery);